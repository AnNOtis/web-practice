<!DOCTYPE HTML>
<html>
<head>
  <style type="text/css">
  body {


  }
  #canvas{
    position: absolute;
    width: 500px;
    height: 500px;
    top: 50px;
    left:50px;
    border: 1px solid #777;
    background: #022146;

  }
  </style>
  <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
  <script type="text/javascript" src="raphael-min.js"></script>
  <script type="text/javascript">
  Raphael.st.timedraggable = function(arr) {
    var me = this,
    lx = 0,
    ly = 0,
    ox = 0,
    oy = 0,
    d_arr = arr,
    moveFnc = function(dx, dy) {
      lx = dx + ox;
      ly = oy;
      me.transform('t' + lx + ',' + ly);
      me.attr({"stroke-width":4,"fill-opacity":1});
console.log("lx:"+lx);
      var data_attr = {fill:"#fff",opacity:"0",height:0};
      var data_ani_attr = {height:200};
      if(lx>-150&&lx<-50 ){

          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=0){d_arr[j].attr(data_attr);}
            
          }
          d_arr[0].attr({opacity:1});
           d_arr[0].animate(data_ani_attr,700,"elastic");
      }else if(lx>-50&&lx<50){
          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=1){d_arr[j].attr(data_attr);};
          }
          d_arr[1].attr({opacity:1});
          d_arr[1].animate(data_ani_attr,700,"elastic");
      }else if(lx>50&&lx<150){

          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=2){d_arr[j].attr(data_attr);}
          }
          d_arr[2].attr({opacity:1});
          d_arr[2].animate(data_ani_attr,700,"elastic");
      }else{
        for(var j = 0;j<d_arr.length;j++ ){
            d_arr[j].attr(data_attr);
          }
      }



    },
    startFnc = function() {
      var data_attr = {fill:"#fff",opacity:"0",height:0};
      var data_ani_attr = {height:200};
      if(lx>-150&&lx<-50 ){

          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=0){d_arr[j].attr(data_attr);}
            
          }
          d_arr[0].attr({opacity:1});
           d_arr[0].animate(data_ani_attr,700,"elastic");
      }else if(lx>-50&&lx<50){
          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=1){d_arr[j].attr(data_attr);};
          }
          d_arr[1].attr({opacity:1});
          d_arr[1].animate(data_ani_attr,700,"elastic");
      }else if(lx>50&&lx<150){

          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=2){d_arr[j].attr(data_attr);}
          }
          d_arr[2].attr({opacity:1});
          d_arr[2].animate(data_ani_attr,700,"elastic");
      }else{
        for(var j = 0;j<d_arr.length;j++ ){
            d_arr[j].attr(data_attr);
          }
      }


    },
    endFnc = function() {
      ox = lx;
      oy = ly;
      me.attr({"stroke-width":2,"fill-opacity":1});
var data_attr = {fill:"#fff",opacity:"0",height:0};
      var data_ani_attr = {height:200};
      if(lx>-150&&lx<-50 ){

          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=0){d_arr[j].attr(data_attr);}
            
          }
          d_arr[0].attr({opacity:1});
           d_arr[0].animate(data_ani_attr,700,"elastic");
      }else if(lx>-50&&lx<50){
          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=1){d_arr[j].attr(data_attr);};
          }
          d_arr[1].attr({opacity:1});
          d_arr[1].animate(data_ani_attr,700,"elastic");
      }else if(lx>50&&lx<150){

          for(var j = 0;j<d_arr.length;j++ ){
            if(j!=2){d_arr[j].attr(data_attr);}
          }
          d_arr[2].attr({opacity:1});
          d_arr[2].animate(data_ani_attr,700,"elastic");
      }else{
        for(var j = 0;j<d_arr.length;j++ ){
            d_arr[j].attr(data_attr);
          }
      }




    };

    this.drag(moveFnc, startFnc, endFnc);
  };
  Raphael.fn.timeline_arrow = function (x, y, size,arr) {
   

    var data_arr = arr;

     var c = this.circle(x,y-size*3.5,size).attr({fill:"#FF5C4A","stroke-width":2,stroke:"#FDE24D","fill-opacity":0.1});
     var p =this.path("M"+x+" "+(y-size*2.5)+"L"+x+" "+(y+size*2)).attr({stroke:"#FDE24D","stroke-width":2,"arrow-end":"classic-wide-long","stroke-linecap":"round"});
     var st = this.set();

     st.push(c,p);
     st.hover(function() {
      st.attr({"stroke-width":4,"fill-opacity":1});

    },function() {
      st.attr({"stroke-width":2,"fill-opacity":0.1});
    });
     st.attr({cursor:"pointer"});
     st.timedraggable(data_arr);
     return this;
   };
   $(
    function() {

      var canvas = Raphael("canvas",500,500);
      
      canvas.path("M0 250L500 250").attr({stroke:"#fff"});

      var month_text = {fill:"#fff","font-size":20};
      var m_arr = [m1,m2,m3]; 
      var m1 = canvas.text(150, 230, "Jul.").attr(month_text);
      var m2 = canvas.text(250, 230, "Aug.").attr(month_text);
      var m3 = canvas.text(350, 230, "Sep.").attr(month_text);

      var data_attr = {fill:"#fff",opacity:"0.2"};
      var data1 = canvas.rect(150-30,285,60,90).attr(data_attr);
      var data2 = canvas.rect(250-30,285,60,90).attr(data_attr);
      var data3 = canvas.rect(350-30,285,60,90).attr(data_attr);

      var d_arr = [data1,data2,data3];
      var m_arr = [m1,m2,m3]; 

      var t_a =  canvas.timeline_arrow(250,250,15,d_arr);

      
    }





    );
   </script>

 </head>
 <body>
  <div id="canvas"></div>


  <script type="text/javascript">

  </script>


</body>
</html>